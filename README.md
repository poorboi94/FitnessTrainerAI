# Fitness Coach AI - UpSmith Agentic Challenge

---

## How to Run This

**Prerequisites:** Python 3.11+ installed on your machine

### 1. Clone the Repository
```bash
git clone https://github.com/poorboi94/FitnessTrainerAI.git
cd FitnessTrainerAI
```

### 2. Create Virtual Environment

**Windows:**
```bash
python -m venv venv
venv\Scripts\activate
```

**Mac/Linux:**
```bash
python3 -m venv venv
source venv/bin/activate
```

### 3. Run the Application

**Windows:**
```bash
python run_streamlit.py
```

**Mac/Linux:**
```bash
python3 run_streamlit.py
```

The app will open at `http://localhost:8501`

**Note:** The repository includes a `.env` file with a Groq API key for immediate testing. No additional setup required.

---

## What It Does

This is a fitness coach with persistent memory. The system remembers user preferences across sessions. If you mention preferring running exercises early in the week, it will incorporate that preference when generating workout plans later.

### The 6 Tools

Each tool is powered by an LLM:

1. **create_workout_plan** - Makes workout plans, remembers if you said "I hate running"
2. **create_meal_plan** - Meal planning that respects your dietary restrictions
3. **analyze_progress** - Looks through chat history to see how you're doing
4. **give_motivation** - Detects if you're struggling and adjusts tone
5. **calculate_calories** - BMR/TDEE calculations using Mifflin-St Jeor equation
6. **injury_prevention** - Safety advice based on exercises you mentioned

### How It Works (The Agentic Part)

```
User asks something
    ↓
Coordinator LLM decides which tool(s) to use
    ↓
Runs the tools (each tool is also an LLM call)
    ↓
Synthesis LLM combines everything into one response
    ↓
Saves to database for memory
```

---

## Design Decisions

### 1. Why Groq instead of OpenAI?

Groq provides free API access with fast inference times. The llama-3.3-70b model performs well for fitness coaching use cases.

For a production deployment, I would consider Claude or GPT-4 for improved response quality, but for this demonstration Groq provides a good balance of performance and accessibility.

### 2. Why SQLite?

SQLite requires zero configuration - the entire database is a single file that's created automatically on first run. This eliminates setup complexity like installing PostgreSQL or configuring Docker.

While this approach has scaling limitations, it's well-suited for a demonstration project where ease of setup is prioritized.

### 3. Why Streamlit instead of React?

Streamlit is pure Python with no JavaScript required which falls in line with showing off my python adaptability. It also provides a chat UI out of the box, which meant more development time could go toward the agent logic.

For this challenge, I prioritized agent architecture over frontend customization.

### 4. Password Storage

Passwords are stored in plain text for this demo. I'm aware this isn't production-ready - there's a TODO comment in the code noting bcrypt should be added for any real deployment.

The tradeoff: bcrypt can have platform-specific installation issues. For a coding challenge where evaluators need to run this easily, I chose simplicity over security best practices.

### 5. Hybrid Memory Architecture

The system combines structured database storage with conversational memory mining.

**Reasoning:** Queries like "What's my BMI?" require precise numerical data that shouldn't be generated by the LLM. These values are stored in the database. However, preference data like "I enjoy running" is more naturally extracted from conversation history rather than requiring rigid schema definitions.

This hybrid approach provides reliable data for calculations while maintaining flexibility for preference tracking.

---

## Making the AI Feel More Human

Several techniques were implemented to make responses feel more natural and personalized:

### 1. Conversation Mining

The workout planning tool scans recent conversation history (last 10 messages) to extract explicit preferences such as "I like running" or "I don't want to lift weights". These preferences are then injected into the tool's system prompt:

```
User LIKES: running, yoga
User DISLIKES: weightlifting, gym
CRITICAL: Never include weightlifting!
```

This ensures workout plans reflect stated preferences rather than providing generic recommendations.

### 2. Sentiment Detection

The motivation tool analyzes recent messages for emotional indicators - negative terms like "tired", "hard", "struggling" versus positive terms like "good", "better", "progress". The detected sentiment adjusts the motivational response:

```python
if "struggling" detected:
    emotional_context = "struggling, needs encouragement"
else:
    emotional_context = "positive, reinforce success"
```

This approach allows the system to provide contextually appropriate motivation.

### 3. Temperature Tuning

Different tools use different temperatures:
- Coordinator: 0.2 (requires consistent JSON output)
- Calorie calculator: 0.3 (prioritizes calculation accuracy)
- Motivation: 0.8 (benefits from creative variation)
- General chat: 0.7 (balances consistency and naturalness)

This temperature variation helps create more natural-feeling interactions across different contexts.

### 4. Profile Integration

Every LLM call includes the user's profile data in the system prompt. This shifts responses from generic:

> "Here's a generic workout plan"

To personalized:

> "Since you're 30 and trying to lose weight, here's a plan that..."

This contextual awareness significantly improves response relevance.

---

## Tools & Tech Stack

- **Python 3.11+** - Main language
- **Streamlit** - Web UI (all Python, no JS)
- **SQLite** - Database (single file, zero config)
- **SQLAlchemy** - ORM for database
- **Groq API** - LLM provider (using llama-3.3-70b-versatile)
- **python-dotenv** - Environment variables

The stack is intentionally minimal - pure Python with no additional infrastructure requirements.

---

## Project Structure

```
agenticChatbot/
  app/
    agent.py          - Main agent logic + 6 tools
    database.py       - SQLAlchemy models
  data/
    fitness_coach.db  - SQLite database (auto-created)
  streamlit_app.py    - Web interface
  run_streamlit.py    - Startup script
  requirements.txt    - Dependencies
```

---

## Database Schema

```
users (id, username, password, created_at)
  |
  +-- user_profiles (age, weight, height, goals, preferences, etc.)
  |
  +-- conversations (all chat messages for memory)
  |
  +-- workouts (future - structured workout data)
  |
  +-- meals (future - structured meal data)
```

Currently, workouts and meals tables remain unpopulated. All interaction data is stored in the conversations table. Future enhancements could parse LLM responses to populate these tables for structured analytics.

---

## Testing

To demonstrate the agent's capabilities:

1. Fill out your profile (age, weight, height, goal)
2. Express preferences: "I like running but hate weightlifting"
3. Request a workout plan: "Create a workout plan for me"
4. Observe that the plan incorporates running and excludes weightlifting
5. Request progress analysis: "How am I doing?"

The coordinator automatically selects appropriate tools based on the query. Complex questions may trigger multiple tool invocations.

---

## Known Issues

- Clear Chat functionality lacks confirmation dialog (noted in TODO)
- Responses are not streamed (noted in TODO)
- Profile form UI could be improved (Streamlit limitation)
- Error handling covers common cases but may not handle all edge cases

---

## What I'd Add With More Time

1. Streaming responses to reduce perceived latency
2. Workout completion tracking with interactive checklists
3. Progress visualization with charts and graphs
4. Voice input integration for hands-free gym use
5. Improved error handling with user-friendly messages

---

## Troubleshooting

**"groq.GroqError: The api_key client option must be set"**
- Add your API key to the `.env` file
- Use `GROQ_API_KEY=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` if you don't want to create an API key

**Database locked error**
- Close any other instances of the app

**Responses are slow**
- Change model to `llama-3.1-8b-instant` in [app/agent.py:38](app/agent.py#L38)

---
